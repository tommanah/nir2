<!doctype HTML>
<html>
<head>
    <title>WebAR без маркеров</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
        AFRAME.registerComponent('place-object', {
            init: function () {
                const el = this.el;

                // Создаем новый объект
                const box = document.createElement('a-box');
                box.setAttribute('material', 'color: red;');
                box.setAttribute('scale', '0.5 0.5 0.5');
                el.sceneEl.appendChild(box); // Добавляем куб в сцену

                // Обработчик события клика
                el.sceneEl.addEventListener('click', function (event) {
                    console.log("Клик зарегистрирован"); // Лог при клике

                    // Получаем координаты мыши
                    const mouseX = (event.clientX / window.innerWidth) * 2 - 1;
                    const mouseY = - (event.clientY / window.innerHeight) * 2 + 1;

                    // Устанавливаем позицию объекта на фиксированное расстояние от камеры
                    const camera = el.sceneEl.camera;
                    const distance = 0.5; // Полметра от камеры

                    // Вычисляем позицию
                    const position = new THREE.Vector3();
                    position.set(mouseX, mouseY, distance);
                    position.unproject(camera); // Преобразуем координаты в мировые

                    // Устанавливаем позицию объекта
                    box.setAttribute('position', position);
                    console.log("Куб добавлен на позицию:", position); // Лог для проверки позиции
                });
            }
        });
    </script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <a-scene embedded arjs='sourceType: webcam;'>
        <a-entity camera></a-entity>
        <a-entity place-object></a-entity> <!-- Добавляем компонент для размещения объекта -->
    </a-scene>
</body>
</html>